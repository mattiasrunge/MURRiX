<div class="fullscreen animated zoomIn" data-bind="css: { showsidebar: showSidebar }">
    <div class="sidebar" data-bind="visible: showSidebar() && item(), if: showSidebar() && item()">
        <h2 style="margin-top: 0;">
            Information
        </h2>

        <table class="text-muted">
            <tbody>
                <tr>
                    <td style="width: 44px;">
                        <i class="material-icons" title="Description">description</i>
                    </td>
                    <td>
                        <widget-node-text-attribute params="{ nodepath: item, name: 'description', html: true }"></widget-node-text-attribute>
                    </td>
                </tr>
                <tr>
                    <td style="width: 44px;">
                        <i class="material-icons" title="File">file_download</i>
                    </td>

                    <td>
                        <a href="#" data-bind="text: item().node().attributes.name, attr: { href: 'file/' + item().node().attributes.diskfilename + '/' + item().node().attributes.name }"></a>
                        (<span data-bind="htmlSize: item().node().attributes.size"></span>)
                        <div data-bind="if: item().versions.length > 0">
                            <small data-bind="foreach: item().versions" style="font-size: 80%;">
                                <a style="color: #999;" href="#" data-bind="text: $data.node.attributes.name, attr: { href: 'file/' + $data.node.attributes.diskfilename + '/' + $data.node.attributes.name }"></a>
                                (<span data-bind="htmlSize: $data.node.attributes.size"></span>)
                            </small>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td style="width: 44px;">
                        <i class="material-icons" title="Created by">person</i>
                    </td>

                    <td>
                        <widget-node-link-node params="{ nodepath: item, name: 'createdBy', niceName: 'person', searchPaths: [ '/people' ] }"></widget-node-link-node>

                        <!--<div data-bind="if: who()">
                            <a href="#" target="_blank" data-bind="text: who().node().attributes.name, location: { page: 'node', path: who().path, showPath: null }"></a>



                        </div>
                        <div data-bind="if: !who()">
                            Unknown
                        </div>-->
                    </td>
                </tr>
                <tr>
                    <td style="width: 44px;">
                        <i class="material-icons" title="Created with">camera</i>
                    </td>

                    <td>
                        <div data-bind="if: device()">
                            <a href="#" target="_blank" data-bind="text: device().node().attributes.name, location: { page: 'node', path: device().path, showPath: null }"></a>
                        </div>
                        <div data-bind="if: !device()">
                            Unknown
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>

        <h3>Comments</h3>

        <comment-widget-comments params="{ path: showPath }"></comment-widget-comments>
    </div>

    <div class="sidebar" data-bind="visible: tagging() && item(), if: tagging() && item()">
        <h2 style="margin: 0;">
            Tag people
        </h2>

        <input type="text" class="form-control" style="margin-top: 15px;" placeholder="Add a person" data-bind="nodeselect: { root: '/people', path: personPath }">

        <div data-bind="foreach: tags">
            <div class="tag-item">
                <div class="clearfix">
                    <div class="btn-group btn-group-sm pull-right" role="group">
                        <button type="button" class="btn btn-primary">Edit</button>
                        <button type="button" class="btn btn-danger" data-bind="click: $component.removeTag.bind($data, $data)">Remove</button>
                    </div>
                    <file-widget-profile-picture class="pull-left" style="margin-right: 15px;" params="{ size: 32, path: $data.path }"></file-widget-profile-picture>
                    <div class="title" data-bind="text: $data.node.attributes.name"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="maincontainer" data-bind="if: item() && filename()">
        <div data-bind="visible: item().node().attributes.type === 'image', if: item().node().attributes.type === 'image'">
            <div data-bind="picture: { item: item, filename: filename, tags: tags, height: $component.height, classes: 'resize-fit-center', nolazyload: true }" class="resize-fit-container"></div>
        </div>
        <div data-bind="visible: item().node().attributes.type === 'video', if: item().node().attributes.type === 'video'" class="resize-fit-container">
            <video autoplay controls preload="metadata" class="resize-fit-center">
                <source src="" type="video/webm" data-bind="attr: { src: filename() }">
                Your browser does not support the video tag.
            </video>
        </div>
        <div data-bind="visible: item().node().attributes.type === 'audio', if: item().node().attributes.type === 'audio'" style="position: absolute; left: 0; right: 0; bottom: 0;">
            <audio autoplay controls preload="metadata" style="width: 100%;">
                <source src="" type="video/webm" data-bind="attr: { src: filename() }">
                Your browser does not support the audio tag.
            </audio>
        </div>
    </div>

    <div data-bind="if: item" class="bottombar">
        <a href="#" data-bind="location: { showPath: previousPath }, visible: previousPath() !== false">
            <i class="material-icons md-48 pull-left">arrow_back</i>
        </a>

        <span class="middle">
            <span>
                <i class="material-icons md-18">access_time</i>
                <span data-bind="datetimeUtc: item().node().attributes.time.timestamp"></span>
            </span>

            <span>
                <i class="material-icons md-18">place</i>
                TODO
            </span>

            <span>
                <i class="material-icons md-18">comment</i>
                <span data-bind="text: commentCount"></span>
            </span>

            <span>
                <i class="material-icons md-18">face</i>
                <span data-bind="text: tags().length"></span>
            </span>
        </span>

        <a href="#" data-bind="location: { showPath: nextPath }, visible: nextPath() !== false">
            <i class="material-icons md-48 pull-right">arrow_forward</i>
        </a>
    </div>

    <a href="#" class="information" data-bind="click: showSidebar.bind($data, true), visible: !showSidebar()">
        <i class="material-icons">info</i>
    </a>

    <a href="#" class="hideinformation" data-bind="click: showSidebar.bind($data, false), visible: showSidebar() && !tagging()">
        <i class="material-icons">forward</i>
    </a>

    <div class="btn-group menu" data-bind="visible: item().editable && !tagging()">
        <a href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <i class="material-icons">more_vert</i>
        </a>
        <ul class="dropdown-menu dropdown-menu-right">
            <li><a href="#" data-bind="click: rotate.bind($data, 90)">
                <i class="material-icons">rotate_left</i>
                Rotate left
            </a></li>
            <li><a href="#" data-bind="click: rotate.bind($data, -90)">
                <i class="material-icons">rotate_right</i>
                Rotate right
            </a></li>
            <li><a href="#" data-bind="click: mirror">
                <i class="material-icons">flip</i>
                Mirror
            </a></li>
            <li role="separator" class="divider"></li>
            <li><a href="#" data-bind="click: tagging.bind($data, true)">
                <i class="material-icons">face</i>
                Tag people
            </a></li>
        </ul>
    </div>

    <a href="#" class="exit" data-bind="click: exit">
        <i class="material-icons">close</i>
    </a>
</div>
