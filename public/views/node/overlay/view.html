<div class="modal-backdrop" data-bind="fadeVisible: nodeModel.overlayModel.show, if: nodeModel.overlayModel.show"></div>
<div style="position: absolute; top: 20px; left: 20px; bottom: 20px; right: 20px; z-index: 2050;" data-bind="fadeVisible: nodeModel.overlayModel.show, if: nodeModel.overlayModel.show">
  <div style="position: absolute; top: 0px; left: 0px; bottom: 0px; right: 370px; text-align: center;">

    <div id="overlayCarousel" class="carousel slide">
      <!-- Carousel items -->
      <div class="carousel-inner" data-bind="foreach: nodeModel.fileNodes">

        <div class="item" data-bind="css: { active: $index() == 0 }">
          <img class="img-rounded" style="display: inline-block; height: auto; max-height: 100%; max-width: 100%; vertical-align: middle; width: auto;" data-bind="attr: { src: 'preview?id=' + $data._id() + '&amp;width=1440', title: $data.name() }" src="http://placekitten.com/g/1440/1440" alt="">
<!--          <div class="carousel-caption">
            <h4 data-bind="text: $data.name"></h4>
            <p data-bind="if: $data.description() != '', text: $data.description"></p>
          </div>-->
        </div>

      </div>
      <!-- Carousel nav -->
      <a class="carousel-control left" href="#" data-bind="click: nodeModel.overlayModel.carouselLeft">&lsaquo;</a>
      <a class="carousel-control right" href="#" data-bind="click: nodeModel.overlayModel.carouselRight">&rsaquo;</a>
    </div>

  </div>
  <div style="position: absolute; top: 0px; width: 350px; bottom: 0px; right: 0px; margin: 0px; padding: 0px; overflow: auto;" class="well">
    <div style="padding: 10px;">
      <a class="pull-right close" data-bind="hrefSecondSecondary: ''" style="font-size: 30px">×</a>
      <h3 data-bind="text: nodeModel.node().name"></h3>
      
      <p class="muted">
        <small>Picture taken 
          <span data-bind="if: nodeModel.overlayModel.node().createdDatetime">on <span data-bind="htmlTimestamp: nodeModel.overlayModel.node().createdDatetime.datetime()"></span></span>
          <span data-bind="">at <a>Marklandsgatan 43</a></span>.
          <br/>Showing <a>Mattias Runge<a>, <a>Björn Ramberg</a> and <a>VW Golf II</a>.
        </small>
      </p>
    </div>
  
    <div class="accordion" id="overlayAccordion" style="height: 100%;">
      <div class="accordion-group">
        <div class="accordion-heading">
          <a class="accordion-toggle" data-toggle="collapse" data-parent="#overlayAccordion" href="#overlayCollapseDetails">
            Details
          </a>
        </div>
        <div id="overlayCollapseDetails" class="accordion-body collapse">
          <div class="accordion-inner" style="padding: 10px;">

            <table class="table table-striped table-condensed">
                <tr>
                  <td>Filename</td>
                  <td data-bind="text: nodeModel.overlayModel.node().name()"></td>
                </tr>
                <tr>
                  <td>File size</td>
                  <td data-bind="htmlSize: nodeModel.overlayModel.node().exif.FileSize()"></td>
                </tr>
                <tr>
                  <td>Image size</td>
                  <td data-bind="text: nodeModel.overlayModel.node().exif.ImageWidth() + 'x' + nodeModel.overlayModel.node().exif.ImageHeight()"></td>
                </tr>
                <tr data-bind="if: nodeModel.overlayModel.node().exif.CameraModelName">
                  <td>Camera model</td>
                  <td data-bind="text: nodeModel.overlayModel.node().exif.CameraModelName()"></td>
                </tr>
                <tr data-bind="if: nodeModel.overlayModel.node().exif.Orientation">
                  <td>Orientation</td>
                  <td data-bind="text: nodeModel.overlayModel.node().exif.Orientation()"></td>
                </tr>
                <tr data-bind="if: nodeModel.overlayModel.node().angle()">
                  <td>Angle</td>
                  <td data-bind="text: nodeModel.overlayModel.node().angle()"></td>
                </tr>
                <tr data-bind="if: nodeModel.overlayModel.node().mirror()">
                  <td>Mirror</td>
                  <td data-bind="text: nodeModel.overlayModel.node().mirror()"></td>
                </tr>

            </table>
    
          </div>
        </div>
      </div>
    
      <div class="accordion-group">
        <div class="accordion-heading">
          <a class="accordion-toggle" data-toggle="collapse" data-parent="#overlayAccordion" href="#overlayCollapseComments">
            Comments
          </a>
        </div>
        <div id="overlayCollapseComments" class="accordion-body collapse in">
          <div class="accordion-inner">

            <div class="row-fluid">
              <div class="span2">
                <img src="" alt="" style="width: 40px; height: 40px;" data-bind="if: userModel.currentUserNode(), srcNodeProfilePicture: [ userModel.currentUserNode()._id(), 40, 40, 1 ]"/>
              </div>
              <blockquote class="span10">
                <form style="margin-bottom: 0px;" data-bind="submit: nodeModel.overlayModel.commentSubmit">
                  <textarea style="width: 218px; height: 60px;" placeholder="Write a comment..." data-bind="hasfocus: true, disable: nodeModel.overlayModel.commentLoading, value: nodeModel.overlayModel.commentText"></textarea>
                  <span class="text-error pull-left" data-bind="disable: nodeModel.overlayModel.commentLoading, text: nodeModel.overlayModel.commentErrorText"></span>
                  <button type="submit" class="btn btn-mini btn-primary pull-right">Comment</button>
                </form>
                
              </blockquote>
            </div>

            <!-- ko foreach: nodeModel.overlayModel.node().comments -->
          
            <div class="row-fluid">
              <div class="span2">
                <img src="" alt="" style="width: 40px; height: 40px;" data-bind="srcNodeProfilePicture: [ $data._addedBy(), 40, 40, 1 ]"/>
              </div>
              <blockquote class="span10">
                <div style="padding-bottom: 5px;" data-bind="text: $data.text"></div>
                <small><span data-bind="htmlTimeAgo: $data.addedDatetime"></span> by <a data-bind="textNodeAttribute: [ $data._addedBy(), 'name' ]"></a></small>
              </blockquote>
            </div>

            <!-- /ko --> 

          </div>
        </div>
      </div>

    </div>
  </div>
</div>
